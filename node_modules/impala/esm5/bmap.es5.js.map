{"version":3,"file":"bmap.es5.js","sources":["../../packages/impala/esm5/bmap/bmap-config.js","../../packages/impala/esm5/bmap/bmap.directive.js","../../packages/impala/esm5/bmap/bmap.module.js","../../packages/impala/esm5/bmap/overlay/generic-marker.js","../../packages/impala/esm5/bmap/overlay/portal-host-overlay.js","../../packages/impala/esm5/bmap/util/wgs84tobd09.js","../../packages/impala/esm5/bmap/index.js"],"sourcesContent":["import { InjectionToken } from '@angular/core';\nexport var /** @type {?} */ BMAP_CONFIG = new InjectionToken('bmap.config');\n//# sourceMappingURL=bmap-config.js.map","import { BMAP_CONFIG } from './bmap-config';\nimport { Directive, Input, ElementRef, NgZone, Output, EventEmitter, Inject } from '@angular/core';\nvar BMapDirective = (function () {\n    /**\n     * @param {?} mapConfig\n     * @param {?} elementRef\n     * @param {?} zone\n     */\n    function BMapDirective(mapConfig, elementRef, zone) {\n        this.mapConfig = mapConfig;\n        this.elementRef = elementRef;\n        this.zone = zone;\n        this.mapLoaded = new EventEmitter();\n    }\n    /**\n     * @return {?}\n     */\n    BMapDirective.prototype.ngAfterViewInit = function () {\n        var _this = this;\n        // this.loader.load().then(() => {\n        var /** @type {?} */ map = this.map = this.zone.runOutsideAngular(function () {\n            return new BMap.Map(_this.elementRef.nativeElement, {\n                enableMapClick: false\n            });\n        });\n        var /** @type {?} */ center = this.mapConfig.center || [120, 30], /** @type {?} */ zoom = this.mapConfig.zoom || 10;\n        if (2 !== center.length) {\n            throw new Error(\"invalid lon lat\");\n        }\n        map.centerAndZoom(new BMap.Point(center[0], center[1]), zoom);\n        this.mapLoaded.emit(map);\n        // });\n    };\n    /**\n     * @param {?} changes\n     * @return {?}\n     */\n    BMapDirective.prototype.ngOnChanges = function (changes) {\n        if (this.map) {\n            if (changes['mapZoom']) {\n                this.map.setZoom(this.mapZoom);\n            }\n            if (changes['mapCenter']) {\n                this.map.setCenter(this.mapCenter);\n            }\n        }\n    };\n    BMapDirective.decorators = [\n        { type: Directive, args: [{\n                    selector: '[bmap]',\n                },] },\n    ];\n    /**\n     * @nocollapse\n     */\n    BMapDirective.ctorParameters = function () { return [\n        { type: undefined, decorators: [{ type: Inject, args: [BMAP_CONFIG,] },] },\n        { type: ElementRef, },\n        { type: NgZone, },\n    ]; };\n    BMapDirective.propDecorators = {\n        'mapLoaded': [{ type: Output },],\n        'mapCenter': [{ type: Input },],\n        'mapZoom': [{ type: Input },],\n    };\n    return BMapDirective;\n}());\nexport { BMapDirective };\nfunction BMapDirective_tsickle_Closure_declarations() {\n    /** @type {?} */\n    BMapDirective.decorators;\n    /**\n     * @nocollapse\n     * @type {?}\n     */\n    BMapDirective.ctorParameters;\n    /** @type {?} */\n    BMapDirective.propDecorators;\n    /** @type {?} */\n    BMapDirective.prototype.mapLoaded;\n    /** @type {?} */\n    BMapDirective.prototype.mapCenter;\n    /** @type {?} */\n    BMapDirective.prototype.mapZoom;\n    /** @type {?} */\n    BMapDirective.prototype.map;\n    /** @type {?} */\n    BMapDirective.prototype.mapConfig;\n    /** @type {?} */\n    BMapDirective.prototype.elementRef;\n    /** @type {?} */\n    BMapDirective.prototype.zone;\n}\n//# sourceMappingURL=bmap.directive.js.map","import { BMAP_CONFIG } from './bmap-config';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { BMapDirective } from './bmap.directive';\nvar BMapModule = (function () {\n    function BMapModule() {\n    }\n    /**\n     * @param {?} config\n     * @return {?}\n     */\n    BMapModule.forRoot = function (config) {\n        return {\n            ngModule: BMapModule,\n            providers: [\n                { provide: BMAP_CONFIG, useValue: config }\n            ]\n        };\n    };\n    BMapModule.decorators = [\n        { type: NgModule, args: [{\n                    declarations: [BMapDirective],\n                    imports: [CommonModule],\n                    exports: [BMapDirective],\n                    providers: [],\n                },] },\n    ];\n    /**\n     * @nocollapse\n     */\n    BMapModule.ctorParameters = function () { return []; };\n    return BMapModule;\n}());\nexport { BMapModule };\nfunction BMapModule_tsickle_Closure_declarations() {\n    /** @type {?} */\n    BMapModule.decorators;\n    /**\n     * @nocollapse\n     * @type {?}\n     */\n    BMapModule.ctorParameters;\n}\n//# sourceMappingURL=bmap.module.js.map","import * as tslib_1 from \"tslib\";\nvar GenericMarker = (function (_super) {\n    tslib_1.__extends(GenericMarker, _super);\n    /**\n     * @param {?} point\n     * @param {?} opts\n     * @param {?} data\n     */\n    function GenericMarker(point, opts, data) {\n        var _this = _super.call(this, point, opts) || this;\n        _this.data = data;\n        return _this;\n    }\n    return GenericMarker;\n}(BMap.Marker));\nexport { GenericMarker };\nfunction GenericMarker_tsickle_Closure_declarations() {\n    /** @type {?} */\n    GenericMarker.prototype.data;\n}\n//# sourceMappingURL=generic-marker.js.map","import * as tslib_1 from \"tslib\";\nimport { DomPortalHost } from '@angular/cdk/portal';\n/**\n *\n */\nvar PortalHostOverlay = (function (_super) {\n    tslib_1.__extends(PortalHostOverlay, _super);\n    /**\n     * @param {?} componentFactoryResolver\n     * @param {?} appRef\n     * @param {?} defaultInjector\n     */\n    function PortalHostOverlay(componentFactoryResolver, appRef, defaultInjector) {\n        var _this = _super.call(this) || this;\n        _this.hostDomElement = document.createElement(\"div\");\n        _this.hostDomElement.style.position = \"absolute\";\n        _this.portalHost = new DomPortalHost(_this.hostDomElement, componentFactoryResolver, appRef, defaultInjector);\n        return _this;\n    }\n    /**\n     * @param {?} portal\n     * @param {?} lon\n     * @param {?} lat\n     * @return {?}\n     */\n    PortalHostOverlay.prototype.attach = function (portal, lon, lat) {\n        this.portalHost.attach(portal);\n        // [lon, lat] = wgs84tobd09(lon, lat);\n        this.point = new BMap.Point(lon, lat);\n        this.draw();\n    };\n    /**\n     * @return {?}\n     */\n    PortalHostOverlay.prototype.detach = function () {\n        this.portalHost.detach();\n    };\n    /**\n     * @param {?} map\n     * @return {?}\n     */\n    PortalHostOverlay.prototype.initialize = function (map) {\n        this.map = map;\n        var /** @type {?} */ panes = map.getPanes();\n        var /** @type {?} */ floatPane = panes.floatPane;\n        if (floatPane) {\n            floatPane.appendChild(this.hostDomElement);\n        }\n        return this.hostDomElement;\n    };\n    /**\n     * @return {?}\n     */\n    PortalHostOverlay.prototype.isVisible = function () {\n        return true;\n    };\n    /**\n     * @return {?}\n     */\n    PortalHostOverlay.prototype.draw = function () {\n        // console.log('PortalHostOverlay::draw()');\n        if (!this.point) {\n            return;\n        }\n        var /** @type {?} */ position = this.map.pointToOverlayPixel(this.point);\n        this.hostDomElement.style.left = position.x /*- this._size / 2 */ + \"px\";\n        this.hostDomElement.style.top = position.y /*- this._size / 2 */ + \"px\";\n    };\n    /**\n     * @return {?}\n     */\n    PortalHostOverlay.prototype.show = function () {\n        this.hostDomElement.style.display = \"\";\n    };\n    /**\n     * @return {?}\n     */\n    PortalHostOverlay.prototype.hide = function () {\n        this.hostDomElement.style.display = \"none\";\n    };\n    return PortalHostOverlay;\n}(BMap.Overlay));\nexport { PortalHostOverlay };\nfunction PortalHostOverlay_tsickle_Closure_declarations() {\n    /** @type {?} */\n    PortalHostOverlay.prototype.map;\n    /** @type {?} */\n    PortalHostOverlay.prototype.point;\n    /** @type {?} */\n    PortalHostOverlay.prototype.hostDomElement;\n    /** @type {?} */\n    PortalHostOverlay.prototype.portalHost;\n}\n//# sourceMappingURL=portal-host-overlay.js.map","/**\n * 经纬度坐标转百度地图坐标\n * @param {?} lon\n * @param {?} lat\n * @return {?}\n */\nexport function wgs84tobd09(lon, lat) {\n    //     [lon, lat] = (<any>coordtransform).wgs84togcj02(lon, lat);\n    //     [lon, lat] = (<any>coordtransform).gcj02tobd09(lon, lat);\n    return [lon, lat];\n}\n//# sourceMappingURL=wgs84tobd09.js.map","/**\n * Generated bundle index. Do not edit.\n */\nexport { BMapDirective, BMapModule, BMAP_CONFIG, GenericMarker, PortalHostOverlay, wgs84tobd09 } from './public-api';\n//# sourceMappingURL=index.js.map"],"names":["tslib_1.__extends"],"mappings":"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"}